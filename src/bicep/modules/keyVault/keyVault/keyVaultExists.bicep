///////////////////////////////////////////////////////////////////////////////////////////////////////
// Copyright (c) 2021-2022 Microsoft Corporation. All rights reserved. This
// Software is licensed under the MIT License. See LICENSE in the project root
// for license information.
///////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Module Description : 
// This module retrieves values from existing key vault.
//
// Assign appropriate values as needed. If needed override global parameters
//
///////////////////////////////////////////////////////////////////////////////////////////////////////

targetScope = 'resourceGroup'

///////////////////////////////////////////////////////////////////////////////////////////////////////
// Section for Bicep parameters
///////////////////////////////////////////////////////////////////////////////////////////////////////

@description('The key vault name')
param p_keyVaultName string

///////////////////////////////////////////////////////////////////////////////////////////////////////
// Section for Bicep parameters
///////////////////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////////////////
// Section for Bicep resources
///////////////////////////////////////////////////////////////////////////////////////////////////////

resource keyVaultExists 'Microsoft.KeyVault/vaults@2019-09-01'  existing = {
  name: p_keyVaultName
}

///////////////////////////////////////////////////////////////////////////////////////////////////////
// Section for Bicep output
///////////////////////////////////////////////////////////////////////////////////////////////////////

@description('Id of Key vault')
output o_id string = keyVaultExists.id

@description('Name of key vault')
output o_keyVaultName string = keyVaultExists.name

@description('Resource group of key vault')
output o_keyVaultResourceGroup string = resourceGroup().name

@description('URI of key vault')
output o_vaultUri string = keyVaultExists.properties.vaultUri
