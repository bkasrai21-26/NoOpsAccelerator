///////////////////////////////////////////////////////////////////////////////////////////////////////
// Copyright (c) 2021-2022 Microsoft Corporation. All rights reserved. This
// Software is licensed under the MIT License. See LICENSE in the project root
// for license information.
///////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Module Description : 
// This module approved private endpoint connections
//
// Assign appropriate values as needed. If needed override global parameters
//
///////////////////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////////////////
// Section for Bicep parameters
///////////////////////////////////////////////////////////////////////////////////////////////////////
@description('Name of Synapse Workspace Name')
param p_workspaceName string

@description('Prefix for  resource name')
param p_nameIdentifier string

///////////////////////////////////////////////////////////////////////////////////////////////////////
// Section for Bicep variables
///////////////////////////////////////////////////////////////////////////////////////////////////////

var v_privateLinkHubName = toLower(replace('plh-${p_nameIdentifier}', '-', ''))

 
///////////////////////////////////////////////////////////////////////////////////////////////////////
// Section for Bicep resources
///////////////////////////////////////////////////////////////////////////////////////////////////////

resource synapseWorkspace 'Microsoft.Synapse/workspaces@2021-06-01'  existing = {
  name: p_workspaceName
}

resource synapsePrivateLinkHubEndpointConn 'Microsoft.Synapse/workspaces/privateEndpointConnections@2021-06-01' = {
  name: 'ep-${v_privateLinkHubName}-conn'
  parent: synapseWorkspace
  properties: {
    privateEndpoint: {}
    privateLinkServiceConnectionState: {
      description: 'Auto-Approved'
      status: 'Approved'
    }
  }
}
///////////////////////////////////////////////////////////////////////////////////////////////////////
// Output Section
///////////////////////////////////////////////////////////////////////////////////////////////////////

