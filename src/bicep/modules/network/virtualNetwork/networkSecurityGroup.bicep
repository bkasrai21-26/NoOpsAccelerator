///////////////////////////////////////////////////////////////////////////////////////////////////////
// Copyright (c) 2021-2022 Microsoft Corporation. All rights reserved. This
// Software is licensed under the MIT License. See LICENSE in the project root
// for license information.
///////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Module Description : 
// This module implements network security rules
//
// Assign appropriate values as needed. If needed override global parameters
//
///////////////////////////////////////////////////////////////////////////////////////////////////////


 targetScope='resourceGroup'

///////////////////////////////////////////////////////////////////////////////////////////////////////
// Section for Bicep parameters
///////////////////////////////////////////////////////////////////////////////////////////////////////
 
@description('unique name identifier')
param p_networkSecurityGroup string 
  
@description('The location to deploy the virtual network.')
param p_location string = resourceGroup().location

@description('The tags to associate to the virtual network.')
param p_tags object = {}

@description('Collection of security rules of the network security group')
param p_securityRules array = []

///////////////////////////////////////////////////////////////////////////////////////////////////////
// Section for Bicep variables
///////////////////////////////////////////////////////////////////////////////////////////////////////

 var v_mddTag = {
  MDDTagName: 'MDD1'
}
var v_tags = union(v_mddTag, p_tags)


///////////////////////////////////////////////////////////////////////////////////////////////////////
// Section for Bicep resources
///////////////////////////////////////////////////////////////////////////////////////////////////////

resource networkSecurityGroup 'Microsoft.Network/networkSecurityGroups@2021-03-01' = {
  name: p_networkSecurityGroup
  location: p_location
  tags: v_tags
  properties: {
     securityRules: p_securityRules
    }
  }


///////////////////////////////////////////////////////////////////////////////////////////////////////
// Section for Bicep output
///////////////////////////////////////////////////////////////////////////////////////////////////////

output o_networkSecurityGroupId string = networkSecurityGroup.id
output o_networkSecurityGroupName string = networkSecurityGroup.name
